{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'gestiune_comenzi.css' %}">
{% endblock %}

{% block content %}
<div class="gestiune-container">
    <div class="gestiune-header">
        <h1 class="page-title">Registru Comenzi</h1>
    </div>

    <div class="search-container">
        <form method="get" class="search-form">
            <input type="text" name="q" class="search-input" placeholder="CautÄƒ dupÄƒ Nume Client sau ID ComandÄƒ..."
                value="{{ search_query }}">
            <button type="submit" class="search-btn">ğŸ” CautÄƒ</button>

            {% if search_query %}
            <a href="{% url 'lista_gestiune_comenzi' %}" class="reset-btn">âŒ ReseteazÄƒ</a>
            {% endif %}
        </form>
    </div>

    <div class="table-responsive">
        <table class="coffee-table">
            <thead>
                <tr>
                    <th>ID ComandÄƒ</th>
                    <th>Client</th>
                    <th>Data & Ora</th>
                    <th>Total</th>
                    <th>Angajat Procesator</th>
                    <th>AcÈ›iuni</th>
                </tr>
            </thead>
            <tbody>
                {% for comanda in comenzi %}
                <tr>
                    <td class="id-cell">#{{ comanda.id }}</td>

                    <td class="client-name">
                        {{ comanda.client.nume }}
                    </td>

                    <td>{{ comanda.data_comenzii|date:"d.m.Y H:i" }}</td>

                    <td class="total-cell">{{ comanda.total_comanda|floatformat:2 }} RON</td>

                    <td>{{ comanda.angajat.nume }} {{ comanda.angajat.prenume }}</td>

                    <td class="actions-cell">
                        <a href="{% url 'detalii_comanda' comanda.id %}" class="btn-icon view" title="Vezi Detalii">
                            ğŸ‘ï¸
                        </a>

                        <form action="{% url 'sterge_comanda' comanda.id %}" method="post"
                            onsubmit="return confirm('È˜tergi comanda #{{ comanda.id }}?');" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit" class="btn-icon delete" title="È˜terge">
                                ğŸ—‘ï¸
                            </button>
                        </form>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" style="text-align: center; padding: 30px;">
                        {% if search_query %}
                        Nu am gÄƒsit nicio comandÄƒ pentru "<strong>{{ search_query }}</strong>".
                        {% else %}
                        Nu existÄƒ comenzi Ã®nregistrate.
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div style="margin-top: 20px;">
        <a href="{% url 'dashboard' %}" style="color: #d4a373; text-decoration: none;">&larr; Ãnapoi la Dashboard</a>
    </div>
</div>
{% endblock %}